<%- include('../partials/head', { pageTitle: 'Galería Colectiva' }) %>
<%- include('../partials/navbar') %>
<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/addons/p5.sound.min.js"></script>

<main>
  <h1 class="text-center mt-4 mb-4">Galería Colectiva - Webcam Pixelada</h1>

  <div id="sketch-container"></div>

  <!-- Formulario para subir imágenes -->
  <div class="card-botones mt-5">
    <h3>Subí tu imagen a la galería colectiva</h3>
    <form action="/obra/sketch3/upload" method="POST" enctype="multipart/form-data">
      <div class="mb-3">
        <label for="userFiles" class="form-label">Elegí una imagen</label>
        <input type="file" name="userFiles" id="userFiles" class="form-control" accept="image/png, image/jpeg" required>
      </div>
      <div class="mb-3">
        <label for="descImg" class="form-label">Descripción</label>
        <input type="text" name="descImg" id="descImg" class="form-control" required>
      </div>
      <button type="submit" class="btn btn-primary">Subir imagen</button>
    </form>
  </div>

  <!-- Galería de imágenes subidas -->
  <div class="conteiner-galeria mt-5">
    <h3>Imágenes en la galería colectiva</h3>
    <div class="row">
      <% if (locals.images && images.length > 0) { %>
        <% for(let img of images) { %>
          <div class="col-md-4 mb-4">
            <img src="/uploads/<%= img.filehash %>" class="img-fluid" alt="<%= img.filedesc %>">
            <p class="text-muted mt-2"><strong><%= img.username %>:</strong> <%= img.filedesc %></p>
          </div>
        <% } %>
      <% } else { %>
        <p>Todavía no hay imágenes en la galería. ¡Sé el primero en subir una!</p>
      <% } %>
    </div>
  </div>
</main>

<script src="/public/p5/obra/sketch3.js"></script>

<%- include('../partials/foot') %>